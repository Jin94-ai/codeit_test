# AIHub 데이터 통합 가이드

클래스 불균형 해결을 위해 AIHub 공개 데이터셋을 활용합니다.

## 📋 개요

- **목적**: 56개 TARGET_CLASSES의 데이터를 클래스당 최대 200개까지 확보
- **데이터셋**: [166.약품식별 인공지능 개발을 위한 경구약제 이미지 데이터](https://www.aihub.or.kr)
- **처리 방식**: 조합(combo) 데이터만 사용 (단일 제외)

## 🚀 사용 방법

### 1. 데이터 다운로드 (수동)

AIHub에서 다운로드:
- **라벨링데이터**: `TL_1_조합.zip ~ TL_X_조합.zip`
- **원천데이터**: `TS_1_조합.zip ~ TS_X_조합.zip`

다운로드 위치:
```
data/166.약품식별 인공지능 개발을 위한 경구약제 이미지 데이터/
├── 01.데이터/1.Training/
    ├── 라벨링데이터/경구약제조합 5000종/  ← TL_*.zip 여기에
    └── 원천데이터/경구약제조합 5000종/    ← TS_*.zip 여기에
```

### 2. 라벨링 데이터 통합

```bash
python integrate_aihub.py
```

**기능**:
- TL ZIP 자동 압축 해제
- TARGET_CLASSES만 필터링
- JSON 포맷 수정 (category_id, name)
- 클래스당 200개 제한
- 결과: `data/aihub_integrated/annotations/`

### 3. 이미지 추출

```bash
python extract_needed_images.py
```

**기능**:
- JSON에 필요한 이미지만 선택적 추출
- TS ZIP에서 PNG 파일 추출
- 2TB 전체가 아닌 필요한 5,000여개만 추출
- 결과: `data/aihub_integrated/images/`

### 4. Competition 데이터와 병합

```bash
python merge_datasets.py
```

**기능**:
- AIHub 데이터를 Competition 폴더로 복사
- `data/train/` + `data/train_annotations/`에 추가
- 원본(`data/aihub_integrated/`) 유지
- 이미 존재하는 파일 건너뛰기

## 📊 결과

예상 결과:
- **JSON**: ~9,900개 추가
- **이미지**: ~5,600개 추가
- **커버리지**: 54/56 클래스
- **평균**: 클래스당 ~177개

## 📁 파일 설명

| 파일 | 용도 |
|------|------|
| `integrate_aihub.py` | 라벨링 ZIP 압축 해제 및 JSON 통합 |
| `extract_needed_images.py` | 필요한 이미지만 선택적 추출 |
| `merge_datasets.py` | Competition 데이터셋에 병합 |

## ⚠️ 주의사항

1. **TS2 제외**: 다운로드 시 TS2는 제외 (용량 문제)
2. **조합만 사용**: 단일(single) 데이터는 처리하지 않음
3. **원본 유지**: 병합 후에도 `data/aihub_integrated/` 유지됨
4. **용량**: 최종적으로 ~20GB 정도 필요

## 🔧 TARGET_CLASSES

총 56개 클래스:
```python
'1899', '2482', '3350', '3482', '3543', '3742', '3831', '4542',
'12080', '12246', '12777', '13394', '13899', '16231', '16261', '16547',
'16550', '16687', '18146', '18356', '19231', '19551', '19606', '19860',
'20013', '20237', '20876', '21324', '21770', '22073', '22346', '22361',
'24849', '25366', '25437', '25468', '27732', '27776', '27925', '27992',
'28762', '29344', '29450', '29666', '30307', '31862', '31884', '32309',
'33008', '33207', '33879', '34596', '35205', '36636', '38161', '41767'
```
